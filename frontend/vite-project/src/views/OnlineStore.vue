<template>
    <div class="store-container">
      <div class="store-header">
        <h2>–ú–æ–±–∏–ª—å–Ω—ã–π –ú–∞–≥–∞–∑–∏–Ω</h2>
        <div class="cart-indicator" @click="showCart = !showCart">
          üõí {{ cartItems.length }}
        </div>
      </div>
  
      <div class="product-grid">
        <div v-for="product in products" :key="product.id" class="product-card">
          <img :src="product.image" class="product-image" />
          <h3>{{ product.name }}</h3>
          <p>{{ product.price }} ‚ÇΩ</p>
          <button @click="spawnMultipleBalls(5)">–ó–∞–∫–∞–∑–∞—Ç—å</button>
        </div>
      </div>
  
      <div v-if="showCart" class="cart-overlay">
        <div class="cart-content">
          <h3>–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞</h3>
          <div v-for="item in cartItems" :key="item.id" class="cart-item">
            <img :src="item.image" class="cart-item-image" />
            <div class="cart-item-info">
              <p>{{ item.name }}</p>
              <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: {{ item.quantity }}</p>
            </div>
            <button @click="removeFromCart(item.id)">√ó</button>
          </div>
          <button class="checkout-btn" @click="checkout">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
      </div>
    </div>
  </template>
  
  <script>
  import { ref } from 'vue'
  
  export default {
    setup() {
            const showCart = ref(false)
    const cartItems = ref([])
    
      const products = ref([
        { id: 1, name: '–°–º–∞—Ä—Ç—Ñ–æ–Ω', price: 29999, image: '/images/phone.png' },
        { id: 2, name: '–ù–∞—É—à–Ω–∏–∫–∏', price: 7999, image: '/images/headphones.png' },
        { id: 3, name: '–ß–µ—Ö–æ–ª', price: 1499, image: '/images/case.png' },
      ])
  
      // –§—É–Ω–∫—Ü–∏—è —Å–ø–∞–≤–Ω–∞ —à–∞—Ä–æ–≤
      function spawnMultipleBalls(count) {
        for (let i = 0; i < count; i++) {
          setTimeout(() => {
            // –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º—ã–π –≤—ã–∑–æ–≤ –≤–Ω–µ—à–Ω–µ–≥–æ API mp
            if (true) {
              window.mp.trigger('spawnBallNearby')
            } else {
              console.log('spawnObjectNearby triggered', false)
            }
          }, i * 500)
        }
      }
  

      return { 
        spawnMultipleBalls,
        products,
      cartItems,
      showCart,
      }
    }
  }
  </script>
  
  <style scoped>
  .store-container {
    padding: 20px;
    height: 100%;
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(10px);
  }
  
  .store-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }
  
  .product-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
  }
  
  .product-card {
    background: rgba(255, 255, 255, 0.9);
    padding: 15px;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    text-align: center;
  }
  
  .product-image {
    width: 100px;
    height: 100px;
    object-fit: contain;
  }
  
  .cart-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: flex;
    justify-content: center;
    align-items: center;
  }
  
  .cart-content {
    background: white;
    padding: 20px;
    border-radius: 15px;
    max-width: 400px;
    width: 90%;
  }
  
  .cart-item {
    display: flex;
    align-items: center;
    margin: 10px 0;
  }
  
  .cart-item-image {
    width: 50px;
    height: 50px;
    margin-right: 10px;
  }
  
  .checkout-btn {
    background: #007aff;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 8px;
    margin-top: 15px;
    width: 100%;
  }
  </style>